<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; padding: 1rem; background: #f0e6ff; }
  h2 { color: #6a00d2; }
  button { margin-top: 1rem; padding: 8px 15px; border:none; background:#6a00d2; color:#fff; border-radius:5px; cursor:pointer; }
  button:hover { background:#4a00a3; }
  ul { list-style:none; padding-left: 0; }
  li { background:#fff; margin-bottom:8px; padding:10px; border-radius:5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);}
  form { margin-top: 20px; max-width: 400px; }
  input, textarea, select, button { width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-size: 1rem; }
</style>
</head>
<body>

<h2>Welcome, <span id="adminName"></span></h2>

<h3>Users</h3>
<ul id="usersList"></ul>

<h3>Post New Notice</h3>
<form id="noticeForm">
  <input type="text" id="title" placeholder="Notice Title" required />
  <textarea id="content" placeholder="Notice Content" rows="4" required></textarea>
  <select id="toUserId">
    <option value="">All Students</option>
  </select>
  <button type="submit">Post Notice</button>
</form>

<button id="logoutBtn">Logout</button>

<script>
  const user = JSON.parse(localStorage.getItem('currentUser'));
  if (!user || user.role !== 'admin') {
    alert('Unauthorized access!');
    window.location.href = 'index.html';
  } else {
    document.getElementById('adminName').textContent = user.name;
  }

  // Hardcoded users
  let users = [
    { username: 'student1', name: 'Student One', role: 'student' },
    { username: 'mentor1', name: 'Mentor One', role: 'mentor' },
    { username: 'admin1', name: 'Admin User', role: 'admin' },
    { username: 'student2', name: 'Student Two', role: 'student' }
  ];

  const usersList = document.getElementById('usersList');
  function renderUsers() {
    usersList.innerHTML = '';
    users.forEach(u => {
      const li = document.createElement('li');
      li.textContent = `${u.name} (${u.role})`;
      usersList.appendChild(li);
    });
  }
  renderUsers();

  // Populate students dropdown for notice posting
  const students = users.filter(u => u.role === 'student');
  const select = document.getElementById('toUserId');
  students.forEach(s => {
    const option = document.createElement('option');
    option.value = s.username;
    option.textContent = s.name;
    select.appendChild(option);
  });

  // Load notices from localStorage
  let notices = JSON.parse(localStorage.getItem('notices')) || [];

  function renderNotices() {
    // For admin you can add a notices list if you want
  }

  document.getElementById('noticeForm').addEventListener('submit', e => {
    e.preventDefault();
    const title = document.getElementById('title').value.trim();
    const content = document.getElementById('content').value.trim();
    const toUserId = document.getElementById('toUserId').value;

    notices.push({
      title,
      content,
      to_user_id: toUserId || '',
      posted_by: user.username,
      created_at: new Date().toISOString()
    });

    localStorage.setItem('notices', JSON.stringify(notices));

    e.target.reset();
    alert('Notice posted!');
  });

  document.getElementById('logoutBtn').onclick = () => {
    localStorage.removeItem('currentUser');
    window.location.href = 'index.html';
  };
</script>

</body>
</html>
