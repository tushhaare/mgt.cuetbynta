<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mentor Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; padding: 1rem; background: #fff7e6; }
  h2 { color: #d17f00; }
  button { margin-top: 1rem; padding: 8px 15px; border:none; background:#d17f00; color:#fff; border-radius:5px; cursor:pointer; }
  button:hover { background:#a66100; }
  ul { list-style:none; padding-left: 0; }
  li { background:#fff; margin-bottom:8px; padding:10px; border-radius:5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);}
  form { margin-top: 20px; max-width: 400px; }
  input, textarea, select, button { width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-size: 1rem; }
</style>
</head>
<body>

<h2>Welcome, <span id="mentorName"></span></h2>

<h3>Your Notices</h3>
<ul id="noticesList"></ul>

<h3>Post New Notice</h3>
<form id="noticeForm">
  <input type="text" id="title" placeholder="Notice Title" required />
  <textarea id="content" placeholder="Notice Content" rows="4" required></textarea>
  <select id="toUserId">
    <option value="">All Students</option>
  </select>
  <button type="submit">Post Notice</button>
</form>

<button id="logoutBtn">Logout</button>

<script>
  const user = JSON.parse(localStorage.getItem('currentUser'));
  if (!user || user.role !== 'mentor') {
    alert('Unauthorized access!');
    window.location.href = 'index.html';
  } else {
    document.getElementById('mentorName').textContent = user.name;
  }

  // Hardcoded students list (could be extended)
  const students = [
    { username: 'student1', name: 'Student One' },
    { username: 'student2', name: 'Student Two' }
  ];

  // Populate students dropdown
  const select = document.getElementById('toUserId');
  students.forEach(s => {
    const option = document.createElement('option');
    option.value = s.username;
    option.textContent = s.name;
    select.appendChild(option);
  });

  // Load notices from localStorage
  let notices = JSON.parse(localStorage.getItem('notices')) || [];

  function renderNotices() {
    const ul = document.getElementById('noticesList');
    ul.innerHTML = '';
    if (notices.length === 0) {
      ul.innerHTML = '<li>No notices posted yet.</li>';
    } else {
      notices.forEach(n => {
        const li = document.createElement('li');
        let toUserText = n.to_user_id ? ` (To: ${n.to_user_id})` : ' (To: All Students)';
        li.innerHTML = `<strong>${n.title}</strong>${toUserText}<br>${n.content}`;
        ul.appendChild(li);
      });
    }
  }
  renderNotices();

  document.getElementById('noticeForm').addEventListener('submit', e => {
    e.preventDefault();
    const title = document.getElementById('title').value.trim();
    const content = document.getElementById('content').value.trim();
    const toUserId = document.getElementById('toUserId').value;

    notices.push({
      title,
      content,
      to_user_id: toUserId || '',
      posted_by: user.username,
      created_at: new Date().toISOString()
    });

    localStorage.setItem('notices', JSON.stringify(notices));
    renderNotices();

    e.target.reset();
    alert('Notice posted!');
  });

  document.getElementById('logoutBtn').onclick = () => {
    localStorage.removeItem('currentUser');
    window.location.href = 'index.html';
  };
</script>

</body>
</html>
